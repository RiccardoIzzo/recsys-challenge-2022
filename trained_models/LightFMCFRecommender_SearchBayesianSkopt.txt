SearchBayesianSkopt: Resuming 'LightFMCFRecommender' Failed, no such file exists.
SearchBayesianSkopt: New best config found. Config 0: {'epochs': 30, 'n_components': 228, 'loss': 'warp', 'sgd_mode': 'adagrad', 'learning_rate': 3.253850543188087e-05, 'item_alpha': 5.27048012026893e-05, 'user_alpha': 0.0028489704902452738} - results: PRECISION: 0.0216212, PRECISION_RECALL_MIN_DEN: 0.0371363, RECALL: 0.0349145, MAP: 0.0095023, MAP_MIN_DEN: 0.0161338, MRR: 0.0796468, NDCG: 0.0435346, F1: 0.0267050, HIT_RATE: 0.1792060, ARHR_ALL_HITS: 0.0868523, NOVELTY: 0.0030163, AVERAGE_POPULARITY: 0.5158505, DIVERSITY_MEAN_INTER_LIST: 0.1288222, DIVERSITY_HERFINDAHL: 0.9128819, COVERAGE_ITEM: 0.0008939, COVERAGE_ITEM_HIT: 0.0007509, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.1758870, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0004251, SHANNON_ENTROPY: 3.6079536, RATIO_DIVERSITY_HERFINDAHL: 0.9131613, RATIO_DIVERSITY_GINI: 0.0009093, RATIO_SHANNON_ENTROPY: 0.2653061, RATIO_AVERAGE_POPULARITY: 10.1244019, RATIO_NOVELTY: 0.2480815, 
SearchBayesianSkopt: Config evaluated with evaluator_test. Config: {'epochs': 30, 'n_components': 228, 'loss': 'warp', 'sgd_mode': 'adagrad', 'learning_rate': 3.253850543188087e-05, 'item_alpha': 5.27048012026893e-05, 'user_alpha': 0.0028489704902452738} - results:
CUTOFF: 10 - PRECISION: 0.0267984, PRECISION_RECALL_MIN_DEN: 0.0395101, RECALL: 0.0354043, MAP: 0.0119798, MAP_MIN_DEN: 0.0176106, MRR: 0.0956659, NDCG: 0.0488924, F1: 0.0305060, HIT_RATE: 0.2117140, ARHR_ALL_HITS: 0.1067297, NOVELTY: 0.0030162, AVERAGE_POPULARITY: 0.5159467, DIVERSITY_MEAN_INTER_LIST: 0.1283213, DIVERSITY_HERFINDAHL: 0.9128318, COVERAGE_ITEM: 0.0008939, COVERAGE_ITEM_HIT: 0.0007151, ITEMS_IN_GT: 0.8751073, COVERAGE_USER: 0.9921209, COVERAGE_USER_HIT: 0.2100459, USERS_IN_GT: 0.9921209, DIVERSITY_GINI: 0.0004249, SHANNON_ENTROPY: 3.6069813, RATIO_DIVERSITY_HERFINDAHL: 0.9131112, RATIO_DIVERSITY_GINI: 0.0009090, RATIO_SHANNON_ENTROPY: 0.2652346, RATIO_AVERAGE_POPULARITY: 10.1262898, RATIO_NOVELTY: 0.2480729, 

SearchBayesianSkopt: Config 1 is suboptimal. Config: {'epochs': 40, 'n_components': 112, 'loss': 'warp-kos', 'sgd_mode': 'adagrad', 'learning_rate': 6.270469864745703e-06, 'item_alpha': 0.00013340343167549473, 'user_alpha': 0.008104559386677167} - results: PRECISION: 0.0146581, PRECISION_RECALL_MIN_DEN: 0.0240639, RECALL: 0.0222985, MAP: 0.0053712, MAP_MIN_DEN: 0.0086826, MRR: 0.0447596, NDCG: 0.0249438, F1: 0.0176885, HIT_RATE: 0.1225953, ARHR_ALL_HITS: 0.0489096, NOVELTY: 0.0032986, AVERAGE_POPULARITY: 0.3400981, DIVERSITY_MEAN_INTER_LIST: 0.7429850, DIVERSITY_HERFINDAHL: 0.9742967, COVERAGE_ITEM: 0.0044336, COVERAGE_ITEM_HIT: 0.0030749, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.1203248, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0013875, SHANNON_ENTROPY: 5.6723841, RATIO_DIVERSITY_HERFINDAHL: 0.9745949, RATIO_DIVERSITY_GINI: 0.0029680, RATIO_SHANNON_ENTROPY: 0.4171113, RATIO_AVERAGE_POPULARITY: 6.6749770, RATIO_NOVELTY: 0.2713012, 
SearchBayesianSkopt: Config 2 is suboptimal. Config: {'epochs': 65, 'n_components': 213, 'loss': 'warp', 'sgd_mode': 'adagrad', 'learning_rate': 0.008990321805150893, 'item_alpha': 0.002723400763617527, 'user_alpha': 1.1455293333946061e-05} - results: PRECISION: 0.0203754, PRECISION_RECALL_MIN_DEN: 0.0345091, RECALL: 0.0323229, MAP: 0.0088844, MAP_MIN_DEN: 0.0148977, MRR: 0.0749969, NDCG: 0.0402156, F1: 0.0249948, HIT_RATE: 0.1701992, ARHR_ALL_HITS: 0.0814984, NOVELTY: 0.0031063, AVERAGE_POPULARITY: 0.4792728, DIVERSITY_MEAN_INTER_LIST: 0.3322697, DIVERSITY_HERFINDAHL: 0.9332262, COVERAGE_ITEM: 0.0953947, COVERAGE_ITEM_HIT: 0.0026816, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.1670470, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0016844, SHANNON_ENTROPY: 4.5888752, RATIO_DIVERSITY_HERFINDAHL: 0.9335118, RATIO_DIVERSITY_GINI: 0.0036032, RATIO_SHANNON_ENTROPY: 0.3374369, RATIO_AVERAGE_POPULARITY: 9.4065052, RATIO_NOVELTY: 0.2554891, 
SearchBayesianSkopt: Config 3 is suboptimal. Config: {'epochs': 10, 'n_components': 65, 'loss': 'bpr', 'sgd_mode': 'adagrad', 'learning_rate': 2.142357560269747e-05, 'item_alpha': 1.8805584698925914e-05, 'user_alpha': 0.006275042019030121} - results: PRECISION: 0.0203999, PRECISION_RECALL_MIN_DEN: 0.0351154, RECALL: 0.0329885, MAP: 0.0089218, MAP_MIN_DEN: 0.0151667, MRR: 0.0763830, NDCG: 0.0406280, F1: 0.0252101, HIT_RATE: 0.1733810, ARHR_ALL_HITS: 0.0824650, NOVELTY: 0.0030496, AVERAGE_POPULARITY: 0.4931998, DIVERSITY_MEAN_INTER_LIST: 0.1732584, DIVERSITY_HERFINDAHL: 0.9173254, COVERAGE_ITEM: 0.0029319, COVERAGE_ITEM_HIT: 0.0011442, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.1701698, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0004440, SHANNON_ENTROPY: 3.7330695, RATIO_DIVERSITY_HERFINDAHL: 0.9176062, RATIO_DIVERSITY_GINI: 0.0009498, RATIO_SHANNON_ENTROPY: 0.2745064, RATIO_AVERAGE_POPULARITY: 9.6798452, RATIO_NOVELTY: 0.2508231, 
SearchBayesianSkopt: New best config found. Config 4: {'epochs': 10, 'n_components': 173, 'loss': 'warp', 'sgd_mode': 'adadelta', 'learning_rate': 1.7418592973057476e-06, 'item_alpha': 2.020840497056554e-05, 'user_alpha': 9.295935003209602e-05} - results: PRECISION: 0.0298791, PRECISION_RECALL_MIN_DEN: 0.0477051, RECALL: 0.0437660, MAP: 0.0126118, MAP_MIN_DEN: 0.0198322, MRR: 0.0972537, NDCG: 0.0515283, F1: 0.0355133, HIT_RATE: 0.2298938, ARHR_ALL_HITS: 0.1103331, NOVELTY: 0.0031852, AVERAGE_POPULARITY: 0.4277405, DIVERSITY_MEAN_INTER_LIST: 0.5635010, DIVERSITY_HERFINDAHL: 0.9563487, COVERAGE_ITEM: 0.0346467, COVERAGE_ITEM_HIT: 0.0158395, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.2256360, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0016230, SHANNON_ENTROPY: 5.4670393, RATIO_DIVERSITY_HERFINDAHL: 0.9566414, RATIO_DIVERSITY_GINI: 0.0034718, RATIO_SHANNON_ENTROPY: 0.4020116, RATIO_AVERAGE_POPULARITY: 8.3950994, RATIO_NOVELTY: 0.2619727, 
SearchBayesianSkopt: Config evaluated with evaluator_test. Config: {'epochs': 10, 'n_components': 173, 'loss': 'warp', 'sgd_mode': 'adadelta', 'learning_rate': 1.7418592973057476e-06, 'item_alpha': 2.020840497056554e-05, 'user_alpha': 9.295935003209602e-05} - results:
CUTOFF: 10 - PRECISION: 0.0367860, PRECISION_RECALL_MIN_DEN: 0.0507309, RECALL: 0.0437777, MAP: 0.0159480, MAP_MIN_DEN: 0.0219215, MRR: 0.1175608, NDCG: 0.0571909, F1: 0.0399785, HIT_RATE: 0.2698240, ARHR_ALL_HITS: 0.1361292, NOVELTY: 0.0031843, AVERAGE_POPULARITY: 0.4282033, DIVERSITY_MEAN_INTER_LIST: 0.5621102, DIVERSITY_HERFINDAHL: 0.9562097, COVERAGE_ITEM: 0.0346467, COVERAGE_ITEM_HIT: 0.0171625, ITEMS_IN_GT: 0.8751073, COVERAGE_USER: 0.9921209, COVERAGE_USER_HIT: 0.2676980, USERS_IN_GT: 0.9921209, DIVERSITY_GINI: 0.0016147, SHANNON_ENTROPY: 5.4600478, RATIO_DIVERSITY_HERFINDAHL: 0.9565023, RATIO_DIVERSITY_GINI: 0.0034540, RATIO_SHANNON_ENTROPY: 0.4014975, RATIO_AVERAGE_POPULARITY: 8.4041835, RATIO_NOVELTY: 0.2618973, 

SearchBayesianSkopt: Config 5 is suboptimal. Config: {'epochs': 35, 'n_components': 196, 'loss': 'warp', 'sgd_mode': 'adagrad', 'learning_rate': 0.09818136303484383, 'item_alpha': 0.001007271145385994, 'user_alpha': 0.0004016237169765474} - results: PRECISION: 0.0000808, PRECISION_RECALL_MIN_DEN: 0.0001453, RECALL: 0.0001390, MAP: 0.0000175, MAP_MIN_DEN: 0.0000320, MRR: 0.0001749, NDCG: 0.0000599, F1: 0.0001022, HIT_RATE: 0.0008077, ARHR_ALL_HITS: 0.0001749, NOVELTY: 0.0058269, AVERAGE_POPULARITY: 0.0030402, DIVERSITY_MEAN_INTER_LIST: 0.6555706, DIVERSITY_HERFINDAHL: 0.9655555, COVERAGE_ITEM: 0.0039688, COVERAGE_ITEM_HIT: 0.0006793, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.0007927, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0009845, SHANNON_ENTROPY: 5.1175166, RATIO_DIVERSITY_HERFINDAHL: 0.9658510, RATIO_DIVERSITY_GINI: 0.0021060, RATIO_SHANNON_ENTROPY: 0.3763099, RATIO_AVERAGE_POPULARITY: 0.0596689, RATIO_NOVELTY: 0.4792449, 
SearchBayesianSkopt: Config 6 Exception. Config: {'epochs': 300, 'n_components': 240, 'loss': 'bpr', 'sgd_mode': 'adadelta', 'learning_rate': 1.1128115629577967e-06, 'item_alpha': 0.0015688053109207155, 'user_alpha': 0.0040957090404648575} - Exception: Traceback (most recent call last):
  File "C:\Users\izzor\PycharmProjects\recsys-challenge-2022\HyperparameterTuning\SearchAbstractClass.py", line 468, in _objective_function
    result_df, recommender_instance = self._evaluate_on_validation(current_fit_hyperparameters_dict, was_already_evaluated_flag, was_already_evaluated_index)
  File "C:\Users\izzor\PycharmProjects\recsys-challenge-2022\HyperparameterTuning\SearchAbstractClass.py", line 326, in _evaluate_on_validation
    recommender_instance, train_time = self._fit_model(current_fit_hyperparameters)
  File "C:\Users\izzor\PycharmProjects\recsys-challenge-2022\HyperparameterTuning\SearchAbstractClass.py", line 297, in _fit_model
    recommender_instance.fit(*self.recommender_input_args.FIT_POSITIONAL_ARGS,
  File "C:\Users\izzor\PycharmProjects\recsys-challenge-2022\Recommenders\FactorizationMachines\LightFMRecommender.py", line 110, in fit
    self._train_with_early_stopping(epochs,
  File "C:\Users\izzor\PycharmProjects\recsys-challenge-2022\Recommenders\Incremental_Training_Early_Stopping.py", line 199, in _train_with_early_stopping
    self._run_epoch(epochs_current)
  File "C:\Users\izzor\PycharmProjects\recsys-challenge-2022\Recommenders\FactorizationMachines\LightFMRecommender.py", line 137, in _run_epoch
    self.lightFM_model = self.lightFM_model.fit_partial(self.URM_train,
  File "C:\Users\izzor\anaconda3\lib\site-packages\lightfm\lightfm.py", line 647, in fit_partial
    self._check_finite()
  File "C:\Users\izzor\anaconda3\lib\site-packages\lightfm\lightfm.py", line 442, in _check_finite
    raise ValueError(
ValueError: Not all estimated parameters are finite, your model may have diverged. Try decreasing the learning rate or normalising feature values and sample weights

SearchBayesianSkopt: Config 7 is suboptimal. Config: {'epochs': 5, 'n_components': 247, 'loss': 'warp-kos', 'sgd_mode': 'adadelta', 'learning_rate': 0.0028360166799591977, 'item_alpha': 0.0040196357221447725, 'user_alpha': 0.00016567958797072697} - results: PRECISION: 0.0094106, PRECISION_RECALL_MIN_DEN: 0.0147982, RECALL: 0.0135160, MAP: 0.0032134, MAP_MIN_DEN: 0.0050133, MRR: 0.0281187, NDCG: 0.0130116, F1: 0.0110958, HIT_RATE: 0.0827255, ARHR_ALL_HITS: 0.0300116, NOVELTY: 0.0034883, AVERAGE_POPULARITY: 0.2219225, DIVERSITY_MEAN_INTER_LIST: 0.1026981, DIVERSITY_HERFINDAHL: 0.9102696, COVERAGE_ITEM: 0.0029319, COVERAGE_ITEM_HIT: 0.0009654, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.0811934, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0004156, SHANNON_ENTROPY: 3.5708080, RATIO_DIVERSITY_HERFINDAHL: 0.9105482, RATIO_DIVERSITY_GINI: 0.0008890, RATIO_SHANNON_ENTROPY: 0.2625747, RATIO_AVERAGE_POPULARITY: 4.3555886, RATIO_NOVELTY: 0.2869062, 
SearchBayesianSkopt: Config 8 is suboptimal. Config: {'epochs': 35, 'n_components': 288, 'loss': 'warp-kos', 'sgd_mode': 'adagrad', 'learning_rate': 7.055425499858711e-05, 'item_alpha': 0.008534368328213984, 'user_alpha': 5.869695337606535e-05} - results: PRECISION: 0.0138871, PRECISION_RECALL_MIN_DEN: 0.0232501, RECALL: 0.0216851, MAP: 0.0066249, MAP_MIN_DEN: 0.0111941, MRR: 0.0588074, NDCG: 0.0292038, F1: 0.0169314, HIT_RATE: 0.1192178, ARHR_ALL_HITS: 0.0622980, NOVELTY: 0.0033997, AVERAGE_POPULARITY: 0.3141307, DIVERSITY_MEAN_INTER_LIST: 0.4316991, DIVERSITY_HERFINDAHL: 0.9431689, COVERAGE_ITEM: 0.0023241, COVERAGE_ITEM_HIT: 0.0016090, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.1170098, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0006233, SHANNON_ENTROPY: 4.4594393, RATIO_DIVERSITY_HERFINDAHL: 0.9434575, RATIO_DIVERSITY_GINI: 0.0013333, RATIO_SHANNON_ENTROPY: 0.3279190, RATIO_AVERAGE_POPULARITY: 6.1653245, RATIO_NOVELTY: 0.2796174, 
SearchBayesianSkopt: Config 9 is suboptimal. Config: {'epochs': 60, 'n_components': 120, 'loss': 'warp', 'sgd_mode': 'adagrad', 'learning_rate': 2.5364933121300995e-05, 'item_alpha': 1.8699356825033634e-05, 'user_alpha': 0.0003852179524326929} - results: PRECISION: 0.0215943, PRECISION_RECALL_MIN_DEN: 0.0371107, RECALL: 0.0348982, MAP: 0.0094969, MAP_MIN_DEN: 0.0161285, MRR: 0.0796545, NDCG: 0.0435176, F1: 0.0266797, HIT_RATE: 0.1792550, ARHR_ALL_HITS: 0.0868278, NOVELTY: 0.0030163, AVERAGE_POPULARITY: 0.5158499, DIVERSITY_MEAN_INTER_LIST: 0.1288242, DIVERSITY_HERFINDAHL: 0.9128821, COVERAGE_ITEM: 0.0008939, COVERAGE_ITEM_HIT: 0.0007151, ITEMS_IN_GT: 0.8724614, COVERAGE_USER: 0.9814793, COVERAGE_USER_HIT: 0.1759350, USERS_IN_GT: 0.9814793, DIVERSITY_GINI: 0.0004251, SHANNON_ENTROPY: 3.6080962, RATIO_DIVERSITY_HERFINDAHL: 0.9131615, RATIO_DIVERSITY_GINI: 0.0009094, RATIO_SHANNON_ENTROPY: 0.2653166, RATIO_AVERAGE_POPULARITY: 10.1243895, RATIO_NOVELTY: 0.2480816, 
